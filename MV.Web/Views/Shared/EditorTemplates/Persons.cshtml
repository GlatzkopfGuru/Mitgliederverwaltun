@model ICollection<Person>

@if (Model.Count == 0)
{
    <div class="text-center">Select a membership type!</div>
}

@for (int Index = 0; Index < Model.Count; Index++)
{
    <div class="card mb-3">
        <div class="card-header p-0" id="Person_Heading_@Index">
            <h4>
                <button id="Person_Heading_Btn_@Index" class="btn" type="button" data-toggle="collapse" data-target="#Person_Collapse_@Index" aria-expanded="true" aria-controls="Person_Collapse_@Index">
                    Neue Person
                </button>
            </h4>
        </div>

        <div id="Person_Collapse_@Index" class="collapse show" aria-labelledby="Person_Heading_@Index">
            <div class="card-body">
                @Html.Editor($"[{Index}]", "Person", $"Members[{Index}]")
            </div>
        </div>
    </div>

    <script>
            var NameHeaderFunction = function () {
                var Name = "";
                var FirstName = $('div[id="Person_Collapse_@Index"]').find('input[name="Members[@Index].Firstname"]').val();
                if (FirstName != null && FirstName != "")
                    Name = FirstName;
                var Surname = $('div[id="Person_Collapse_@Index"]').find('input[name="Members[@Index].Surname"]').val();
                if (Surname != null && Surname != "") {
                    if (Name == "")
                        Name = Surname;
                    else
                        Name += " " + Surname;
                }

                if (Name == "")
                    Name = "Neue Person";


                $('button[id="Person_Heading_Btn_@Index"]').html(Name);
                console.log("I have done something");
            };


            $('div[id="Person_Collapse_@Index"]').find('input[name="Members[@Index].Firstname"]').change(NameHeaderFunction);
        $('div[id="Person_Collapse_@Index"]').find('input[name="Members[@Index].Surname"]').change(NameHeaderFunction);

        if (@Index == 0) {
            $('div[id="Person_Collapse_@Index"]').collapse('show');
        }

    </script>


}
